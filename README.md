# TelegramAtomicHabits
Приложение для отслеживания и формирования полезных привычек.

### Модель Привычки

*   **Пользователь:** Создатель привычки.
*   **Место:** Место выполнения привычки.
*   **Время:** Время выполнения привычки.
*   **Действие:** Само действие привычки.
*   **Признак приятной привычки (is\_pleasant):** Флаг, указывающий, является ли привычка приятной (например, вознаграждением).
*   **Связанная привычка:** Ссылка на приятную привычку, которая служит вознаграждением (доступно только для полезных привычек).
*   **Периодичность:** Частота выполнения привычки (в днях, по умолчанию ежедневно).
*   **Вознаграждение:** Чем пользователь может себя вознаградить после выполнения (доступно только для полезных привычек).
*   **Время на выполнение:** Максимальное время, которое должно быть потрачено на выполнение привычки (не более 120 секунд).
*   **Признак публичности:** Флаг, определяющий доступность привычки другим пользователям.

### Типы привычек:

*   **Полезная привычка:** Основное действие, которое может сопровождаться вознаграждением или связанной приятной привычкой.
*   **Приятная привычка:** Способ вознаграждения, который не может иметь собственного вознаграждения или связанной привычки.

### Валидация:

1.  Нельзя одновременно указывать **вознаграждение** и **связанную привычку** для одной привычки.
2.  **Время на выполнение** должно быть ≤ 120 секунд.
3.  **Связанные привычки** могут быть только типа "приятная".
4.  **Приятные привычки** не могут иметь **вознаграждение** или **связанную привычку**.
5.  **Периодичность** должна быть ≥ 1 раза в 7 дней (то есть, минимум раз в неделю).

### Пагинация:

*   Вывод списка привычек осуществляется по 5 элементов на страницу.

### Права доступа:

*   **CRUD операции** (Создание, Чтение, Обновление, Удаление) доступны только для собственных привычек пользователя.
*   **Просмотр публичных привычек** доступен всем пользователям без возможности редактирования.

## Интеграции:

*   **Telegram-бот:** Для отправки напоминаний о выполнении привычек.
*   **Celery:** Для обработки отложенных задач (например, отправка напоминаний, обработка периодических проверок).
*   **CORS:** Для обеспечения возможности взаимодействия фронтенда с API.
*   **Автодокументация API:** Генерация документации (например, с использованием Swagger/OpenAPI).


Подключены сторонние пакеты:
Django REST Framework — для реализации API
django-filter — для расширенной фильтрации данных
Настроена обработка медиафайлов для загрузки изображений и аватаров
Реализована поддержка browsable API для удобного тестирования через браузер
2. Модели
Приложение users
Реализована кастомная модель пользователя, наследованная от AbstractUser.
Аутентификация осуществляется по электронной почте.
Дополнительные поля профиля:

Номер телефона
Город проживания
Аватар
Приложение materials
Содержит две основные модели: курс и урок.

#### Модель Course (Курс)
Поле	Описание
name	Название курса
preview	Изображение-превью курса
description	Подробное описание курса
#### Модель Lesson (Урок)
Поле	Описание
name	Название урока
preview	Изображение-превью урока
description	Описание урока
video_url	Ссылка на видеоурок
course	Связь с курсом (внешний ключ, один ко многим)
Между курсом и уроками установлена связь "один ко многим": один курс может содержать несколько уроков, каждый урок принадлежит только одному курсу.

Приложение payments
Содержит модель платежа для фиксации оплаты за курсы или уроки.

#### Модель Payment (Платеж)
Поле	Описание
user	Пользователь, совершивший оплату
date_pay	Дата совершения платежа
lesson	Урок, за который произведена оплата (опционально)
course	Курс, за который произведена оплата (опционально)
money	Сумма оплаты
type_pay	Способ оплаты: наличные или безналичный расчёт
### 3. Реализация CRUD
Курсы
Использован ModelViewSet для реализации всех операций: создание, просмотр, редактирование, удаление
Эндпоинт: /courses/
Уроки
Реализованы через generic-классы: ListCreateAPIView, RetrieveUpdateDestroyAPIView
Полная поддержка всех CRUD-операций
Эндпоинт: /lessons/
Платежи
Использован ReadOnlyModelViewSet
Доступен только просмотр списка и детализации платежей
Эндпоинт: /payments/
Все эндпоинты доступны без авторизации.

4. Сериализаторы
Для модели Course реализован расширенный сериализатор, который:

Выводит основную информацию о курсе
Включает список всех уроков курса с помощью вложенного сериализатора
Отображает количество уроков в курсе
Реализовано с использованием SerializerMethodField и вложенного LessonSerializer.

5. Фильтрация и сортировка
Эндпоинт /materials/payments/ поддерживает:

Фильтрация по:
Курсу
Уроку
Способу оплаты
Сортировка:
По дате оплаты (по возрастанию и убыванию)
Функциональность реализована с помощью DjangoFilterBackend и FilterSet.

6. Тестирование
Все эндпоинты протестированы с использованием Postman
Проверена корректность работы CRUD-операций
Убедились в корректности фильтрации и сортировки
Подтверждён открытый доступ ко всем ресурсам без авторизации
7. URL-ы проекта
Путь	Описание
/admin/	Админ-панель Django
/courses/	Управление курсами
/lessons/	Управление уроками
/payments/	Просмотр платежей
8. Установка проекта
Вариант 1: Установка с использованием Poetry (рекомендуется)
git clone https://github.com/medoed777/SubscriptionManagementSystem.git
cd DjangoDRF
poetry install
poetry shell
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
API будет доступно по адресу: http://localhost:8000/lms/

git clone https://github.com/medoed777/SubscriptionManagementSystem.git
cd DjangoDRF
python -m venv venv
source venv/bin/activate  # Linux/macOS
или
venv\Scripts\activate     # Windows
pip install -r requirements.txt
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver

## Запуск проекта с использованием Docker Compose
#### Этот файл docker-compose.yml определяет конфигурацию для запуска всех необходимых сервисов вашего проекта: веб-приложения Django, базы данных PostgreSQL, Redis и Celery (worker и beat).

Предварительные требования
1. Docker установлен и работает.
2. Docker Compose установлен (обычно входит в состав Docker Desktop).
3. Файл .env с необходимыми переменными окружения (например, DATABASE_NAME, DATABASE_USER, DATABASE_PASSWORD).
### Процесс запуска
Сборка и запуск всех сервисов
1. Перейдите в корневую директорию вашего проекта (где находится файл docker-compose.yml и Dockerfile). 
2. Затем выполните следующую команду:

docker-compose up --build
или
docker-compose -f docker-compose.yml up