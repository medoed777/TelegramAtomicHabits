# TelegramAtomicHabits
Приложение для отслеживания и формирования полезных привычек.

### Модель Привычки

*   **Пользователь:** Создатель привычки.
*   **Место:** Место выполнения привычки.
*   **Время:** Время выполнения привычки.
*   **Действие:** Само действие привычки.
*   **Признак приятной привычки (is\_pleasant):** Флаг, указывающий, является ли привычка приятной (например, вознаграждением).
*   **Связанная привычка:** Ссылка на приятную привычку, которая служит вознаграждением (доступно только для полезных привычек).
*   **Периодичность:** Частота выполнения привычки (в днях, по умолчанию ежедневно).
*   **Вознаграждение:** Чем пользователь может себя вознаградить после выполнения (доступно только для полезных привычек).
*   **Время на выполнение:** Максимальное время, которое должно быть потрачено на выполнение привычки (не более 120 секунд).
*   **Признак публичности:** Флаг, определяющий доступность привычки другим пользователям.

### Типы привычек:

*   **Полезная привычка:** Основное действие, которое может сопровождаться вознаграждением или связанной приятной привычкой.
*   **Приятная привычка:** Способ вознаграждения, который не может иметь собственного вознаграждения или связанной привычки.

### Валидация:

1.  Нельзя одновременно указывать **вознаграждение** и **связанную привычку** для одной привычки.
2.  **Время на выполнение** должно быть ≤ 120 секунд.
3.  **Связанные привычки** могут быть только типа "приятная".
4.  **Приятные привычки** не могут иметь **вознаграждение** или **связанную привычку**.
5.  **Периодичность** должна быть ≥ 1 раза в 7 дней (то есть, минимум раз в неделю).

### Пагинация:

*   Вывод списка привычек осуществляется по 5 элементов на страницу.

### Права доступа:

*   **CRUD операции** (Создание, Чтение, Обновление, Удаление) доступны только для собственных привычек пользователя.
*   **Просмотр публичных привычек** доступен всем пользователям без возможности редактирования.

## Интеграции:

*   **Telegram-бот:** Для отправки напоминаний о выполнении привычек.
*   **Celery:** Для обработки отложенных задач (например, отправка напоминаний, обработка периодических проверок).
*   **CORS:** Для обеспечения возможности взаимодействия фронтенда с API.
*   **Автодокументация API:** Генерация документации (например, с использованием Swagger/OpenAPI).


## Подключены сторонние пакеты:
Django REST Framework — для реализации API
django-filter — для расширенной фильтрации данных
Настроена обработка медиафайлов для загрузки изображений и аватаров
Реализована поддержка browsable API для удобного тестирования через браузер

## Технологический Стек:
Backend: Python (Django REST Framework)
База данных: PostgreSQL (предпочтительно)
Кэширование: Redis
Очередь задач: Celery с Redis/RabbitMQ
Управление зависимостями: Poetry
API документирование: drf-yasg (Swagger/OpenAPI)
## Тестирование:
В данном проекте уделяется особое внимание качеству кода и надежности функционала. Покрытие тестами составляет более 80%. Это достигается за счет использования комплексных юнит- и интеграционных тестов, охватывающих:

- Модели данных: Проверка корректности создания, валидации и сохранения объектов привычек, пользователей и других сущностей.
- API эндпоинты: Тестирование всех CRUD операций, авторизации, пагинации, обработки ошибок и прав доступа.
- Бизнес-логику: Проверка корректной работы логики, связанной с типами привычек, валидационными правилами и взаимодействием между компонентами.
- Celery задачи: Тестирование отправки уведомлений и других фоновых процессов.
- Использование тестов гарантирует, что новые изменения не нарушают существующий функционал и обеспечивают стабильную работу приложения.

## Установка и Запуск:
Данный проект использует Poetry для управления зависимостями.

- Клонируйте репозиторий:
    git clone github.com/medoed777/TelegramAtomicHabits.git
    cd TelegramAtomicHabits
- Создайте и активируйте виртуальное окружение:
python -m venv venv
source venv/bin/activate  # Для Linux/macOS
venv\Scripts\activate  # Для Windows
### Установите зависимости с помощью Poetry:
poetry install
(Примечание: Poetry также позаботится о создании requirements.txt при необходимости.)
Настройте переменные окружения. Рекомендуется использовать файл .env и установить переменную DJANGO_SETTINGS_MODULE в соответствии с вашим файловым путем.
Примените миграции базы данных:
poetry run python manage.py migrate
Запустите сервер разработки Django:
poetry run python manage.py runserver
Для работы напоминаний и отложенных задач, запустите Celery worker:
### Убедитесь, что Redis или RabbitMQ запущены
poetry run celery -A drf_atomic_habits.celery worker -l info
Для запуска всех тестов:
poetry run python manage.py test


## Запуск проекта с использованием Docker Compose
#### Этот файл docker-compose.yml определяет конфигурацию для запуска всех необходимых сервисов вашего проекта: веб-приложения Django, базы данных PostgreSQL, Redis и Celery (worker и beat).

Предварительные требования
1. Docker установлен и работает.
2. Docker Compose установлен (обычно входит в состав Docker Desktop).
3. Файл .env с необходимыми переменными окружения (например, DATABASE_NAME, DATABASE_USER, DATABASE_PASSWORD).
### Процесс запуска
Сборка и запуск всех сервисов
1. Перейдите в корневую директорию вашего проекта (где находится файл docker-compose.yml и Dockerfile). 
2. Затем выполните следующую команду:

docker-compose up --build
или
docker-compose -f docker-compose.yml up